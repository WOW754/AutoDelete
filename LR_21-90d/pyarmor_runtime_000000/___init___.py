import base64
xx = b'''
aW1wb3J0IHlmaW5hbmNlIGFzIHlmDQppbXBvcnQgcGFuZGFzIGFzIHBkDQppbXBvcnQgbnVtcHkgYXMgbnANCmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHQNCmltcG9ydCBtYXRwbG90bGliLmRhdGVzIGFzIG1kYXRlcw0KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YQ0KZnJvbSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbiBpbXBvcnQgdHJhaW5fdGVzdF9zcGxpdA0KZnJvbSBza2xlYXJuLmxpbmVhcl9tb2RlbCBpbXBvcnQgTGluZWFyUmVncmVzc2lvbg0KaW1wb3J0IHJlcXVlc3RzDQppbXBvcnQgaW8NCg0KIyBHZXQgdXNlciBpbnB1dA0KY3J5cHRvMiA9ICdCVEMtVVNEJw0KdGVzdF9zaXplMiA9IDAuMg0KcmFuZG9tX3N0YXRlMiA9IDQyDQoNCiMgRGVmaW5lIHRoZSBkYXkgaW50ZXJ2YWwNCmRheXMgPSBbMjEsIDMwLCA1MCwgNjAsIDkwXQ0KDQpkYXlzX3dlYmhvb2sgPSB7MjE6J2h0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzEzNDM0NjUyNjQwNjY0NjU4MzQvRTNFSWFjQk9tR2VBenB0QTlnOWZpZ3NZUWJ1RE9ERkVKcE40cXVpMzctbWxMbHhPckxOdVZMc2VZdXdkQzlMZmZCMTInLA0KICAgICAgICAgICAgICAgIDMwOidodHRwczovL2Rpc2NvcmQuY29tL2FwaS93ZWJob29rcy8xMzQzNDY1MzM5Mjc4NzIxMDk0L0hxcENXQTFjNl9VbE95SFpLUTV4QjdMWjVhZjRINFAyVzVTdzhGblVrSVd0aUhBNTcxR0xET2dBejNhRmtuR3VqVnNQJywNCiAgICAgICAgICAgICAgICA1MDonaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTM0MzQ2NTQzMjk3NTQwOTE5My9ESElCT2JyY2tKUGRidGNieUdRbkhUbXhCSkU5RVZyT1NZcWZwbHVvRnotanRZNmowUWkwd3NObENOS3ZKLXlfdTVDSicsDQogICAgICAgICAgICAgICAgNjA6J2h0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzEzNDM0NjU1MjQ0Mjc4ODY2MzMvTnY4WXNMMjVlSUl6MlU2cmM1VTE0ekpGb3Iwb0V2amk4T0xqYzhZX0JrMnJoc3NGeVlSOUZIaXdWUDFCQVpMaW5jTGYnLA0KICAgICAgICAgICAgICAgIDkwOidodHRwczovL2Rpc2NvcmQuY29tL2FwaS93ZWJob29rcy8xMzQzNDY1NTk1MzcwMzQ0NTI4L0d1Ni0tcjlUMGUwbkVrRUhFTEFHYnl3cFRKOVNKRE9BS2pRanU5SHlBNzdZcEJQNkRySmZIRXZUS2s1bTZvR091bzJaJ30NCg0KaW50ZXJ2YWxzID0gWycxbScsICcybScsICc1bScsICcxNW0nLCAnMzBtJywgJzYwbScsICc5MG0nLCAnMWgnLCAnMWQnLCAnNWQnLCAnMXdrJywgJzFtbycsICczbW8nXQ0KDQoNCmZvciBkYXkgaW4gZGF5czoNCg0KICAgIGVuZF9kYXRlID0gZGF0ZXRpbWUubm93KCkNCiAgICBzdGFydF9kYXRlID0gZW5kX2RhdGUgLSB0aW1lZGVsdGEoZGF5cz1kYXkpDQogICAgDQogICAgZm9yIGkgaW4gaW50ZXJ2YWxzOg0KICAgICAgICB0cnk6DQoNCiAgICAgICAgICAgICMgRmV0Y2ggaGlzdG9yaWNhbCBwcmljZSBkYXRhDQogICAgICAgICAgICBkYXRhID0geWYuZG93bmxvYWQoY3J5cHRvMiwgc3RhcnQ9c3RhcnRfZGF0ZSwgZW5kPWVuZF9kYXRlLCBpbnRlcnZhbD1pKQ0KDQogICAgICAgICAgICAjIENoZWNrIGlmIGRhdGEgaXMgZW1wdHkNCiAgICAgICAgICAgIGlmIGRhdGEuZW1wdHk6DQogICAgICAgICAgICAgICAgcHJpbnQoIk5vIGRhdGEgZm91bmQgZm9yIHRoZSBnaXZlbiBpbnB1dC4iKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAjIFByZXBhcmUgdGhlIGRhdGENCiAgICAgICAgICAgICAgICBkYXRhWydEYXRlJ10gPSBwZC50b19kYXRldGltZShkYXRhLmluZGV4KQ0KICAgICAgICAgICAgICAgIGRhdGFbJ0RhdGUnXSA9IGRhdGFbJ0RhdGUnXS5tYXAobWRhdGVzLmRhdGUybnVtKSAgIyBDb252ZXJ0IGRhdGVzIHRvIG51bWVyaWMgdmFsdWVzDQoNCiAgICAgICAgICAgICAgICAjIENyZWF0ZSBhIGRhdGFmcmFtZSB3aXRoICdEYXRlJyBhbmQgJ0Nsb3NlJyBjb2x1bW5zDQogICAgICAgICAgICAgICAgZGYgPSBkYXRhW1snRGF0ZScsICdDbG9zZSddXS5jb3B5KCkNCg0KICAgICAgICAgICAgICAgICMgU3BsaXQgdGhlIGRhdGEgaW50byB0cmFpbmluZyBhbmQgdGVzdGluZyBzZXRzDQogICAgICAgICAgICAgICAgWCA9IGRmW1snRGF0ZSddXQ0KICAgICAgICAgICAgICAgIHkgPSBkZlsnQ2xvc2UnXQ0KICAgICAgICAgICAgICAgIFhfdHJhaW4sIFhfdGVzdCwgeV90cmFpbiwgeV90ZXN0ID0gdHJhaW5fdGVzdF9zcGxpdChYLCB5LCB0ZXN0X3NpemU9dGVzdF9zaXplMiwgcmFuZG9tX3N0YXRlPXJhbmRvbV9zdGF0ZTIpDQoNCiAgICAgICAgICAgICAgICAjIFRyYWluIHRoZSBsaW5lYXIgcmVncmVzc2lvbiBtb2RlbA0KICAgICAgICAgICAgICAgIHJlZ3Jlc3NvciA9IExpbmVhclJlZ3Jlc3Npb24oKQ0KICAgICAgICAgICAgICAgIHJlZ3Jlc3Nvci5maXQoWF90cmFpbiwgeV90cmFpbikNCg0KICAgICAgICAgICAgICAgICMgTWFrZSBwcmVkaWN0aW9ucw0KICAgICAgICAgICAgICAgIHlfcHJlZF90cmFpbiA9IHJlZ3Jlc3Nvci5wcmVkaWN0KFhfdHJhaW4pDQogICAgICAgICAgICAgICAgeV9wcmVkX3Rlc3QgPSByZWdyZXNzb3IucHJlZGljdChYX3Rlc3QpDQoNCiAgICAgICAgICAgICAgICAjIFBsb3QgdGhlIGFjdHVhbCBhbmQgcHJlZGljdGVkIHByaWNlcw0KICAgICAgICAgICAgICAgIHBsdC5maWd1cmUoZmlnc2l6ZT0oMTIsIDYpKQ0KICAgICAgICAgICAgICAgIHBsdC5zY2F0dGVyKFhfdHJhaW4sIHlfdHJhaW4sIGNvbG9yPSdibHVlJywgbGFiZWw9J0FjdHVhbCAoVHJhaW4pJykNCiAgICAgICAgICAgICAgICBwbHQuc2NhdHRlcihYX3Rlc3QsIHlfdGVzdCwgY29sb3I9J2dyZWVuJywgbGFiZWw9J0FjdHVhbCAoVGVzdCknKQ0KICAgICAgICAgICAgICAgIHBsdC5wbG90KFhfdHJhaW4sIHlfcHJlZF90cmFpbiwgY29sb3I9J3JlZCcsIGxpbmVzdHlsZT0nOicsIGxhYmVsPSdQcmVkaWN0ZWQgKFRyYWluKScpDQogICAgICAgICAgICAgICAgcGx0LnBsb3QoWF90ZXN0LCB5X3ByZWRfdGVzdCwgY29sb3I9J29yYW5nZScsIGxpbmVzdHlsZT0nOicsIGxhYmVsPSdQcmVkaWN0ZWQgKFRlc3QpJykNCiAgICAgICAgICAgICAgICBwbHQueGxhYmVsKCdEYXRlJykNCiAgICAgICAgICAgICAgICBwbHQueWxhYmVsKGYne2NyeXB0bzJ9IFByaWNlIChVU0QpJykNCiAgICAgICAgICAgICAgICBwbHQudGl0bGUoZid7Y3J5cHRvMn0gUHJpY2UgUHJlZGljdGlvbiAoe2RheX0tRGF5IHtpfS1JbnRlcnZhbCknKQ0KICAgICAgICAgICAgICAgIHBsdC5sZWdlbmQoKQ0KICAgICAgICAgICAgICAgIHBsdC5ncmlkKFRydWUpDQoNCiAgICAgICAgICAgICAgICAjIEFkYXB0aXZlIGxhYmVsIGZvcm1hdHRpbmcgYmFzZWQgb24gdGhlIG51bWJlciBvZiBkYXlzDQogICAgICAgICAgICAgICAgaWYgZGF5IDw9IDIxOiAgIyBTaG9ydGVyIHRpbWUgZnJhbWUsIHVzZSBob3VybHkgbWFya2Vycw0KICAgICAgICAgICAgICAgICAgICBwbHQuZ2NhKCkueGF4aXMuc2V0X21ham9yX2xvY2F0b3IobWRhdGVzLkRheUxvY2F0b3IoaW50ZXJ2YWw9MykpDQogICAgICAgICAgICAgICAgICAgIHBsdC5nY2EoKS54YXhpcy5zZXRfbWFqb3JfZm9ybWF0dGVyKG1kYXRlcy5EYXRlRm9ybWF0dGVyKCclYiAlZCcpKQ0KDQogICAgICAgICAgICAgICAgZWxpZiBkYXkgPD0gMzA6ICAjIERpc3BsYXkgZGFpbHkgbGFiZWxzDQogICAgICAgICAgICAgICAgICAgIHBsdC5nY2EoKS54YXhpcy5zZXRfbWFqb3JfbG9jYXRvcihtZGF0ZXMuRGF5TG9jYXRvcihpbnRlcnZhbD00KSkNCiAgICAgICAgICAgICAgICAgICAgcGx0LmdjYSgpLnhheGlzLnNldF9tYWpvcl9mb3JtYXR0ZXIobWRhdGVzLkRhdGVGb3JtYXR0ZXIoJyViICVkJykpICAjICdGZWIgMTQnIGZvcm1hdA0KDQogICAgICAgICAgICAgICAgZWxpZiBkYXkgPD0gNTA6ICAjIExhYmVsIGV2ZXJ5IDIgZGF5cw0KICAgICAgICAgICAgICAgICAgICBwbHQuZ2NhKCkueGF4aXMuc2V0X21ham9yX2xvY2F0b3IobWRhdGVzLkRheUxvY2F0b3IoaW50ZXJ2YWw9NikpDQogICAgICAgICAgICAgICAgICAgIHBsdC5nY2EoKS54YXhpcy5zZXRfbWFqb3JfZm9ybWF0dGVyKG1kYXRlcy5EYXRlRm9ybWF0dGVyKCclYiAlZCcpKQ0KDQogICAgICAgICAgICAgICAgZWxpZiBkYXkgPD0gNjA6ICAjIExhYmVsIGV2ZXJ5IDMgZGF5cw0KICAgICAgICAgICAgICAgICAgICBwbHQuZ2NhKCkueGF4aXMuc2V0X21ham9yX2xvY2F0b3IobWRhdGVzLkRheUxvY2F0b3IoaW50ZXJ2YWw9NykpDQogICAgICAgICAgICAgICAgICAgIHBsdC5nY2EoKS54YXhpcy5zZXRfbWFqb3JfZm9ybWF0dGVyKG1kYXRlcy5EYXRlRm9ybWF0dGVyKCclYiAlZCcpKQ0KDQogICAgICAgICAgICAgICAgZWxpZiBkYXkgPD0gOTA6ICAjIExhYmVsIGV2ZXJ5IDUgZGF5cw0KICAgICAgICAgICAgICAgICAgICBwbHQuZ2NhKCkueGF4aXMuc2V0X21ham9yX2xvY2F0b3IobWRhdGVzLkRheUxvY2F0b3IoaW50ZXJ2YWw9MTApKQ0KICAgICAgICAgICAgICAgICAgICBwbHQuZ2NhKCkueGF4aXMuc2V0X21ham9yX2Zvcm1hdHRlcihtZGF0ZXMuRGF0ZUZvcm1hdHRlcignJWIgJWQnKSkNCg0KICAgICAgICAgICAgICAgIGVsc2U6ICAjIExvbmctdGVybSBjaGFydHMgKDkwKyBkYXlzKSwgbGFiZWwgd2Vla2x5DQogICAgICAgICAgICAgICAgICAgIHBsdC5nY2EoKS54YXhpcy5zZXRfbWFqb3JfbG9jYXRvcihtZGF0ZXMuV2Vla2RheUxvY2F0b3IoaW50ZXJ2YWw9MikpDQogICAgICAgICAgICAgICAgICAgIHBsdC5nY2EoKS54YXhpcy5zZXRfbWFqb3JfZm9ybWF0dGVyKG1kYXRlcy5EYXRlRm9ybWF0dGVyKCclYiAlZCcpKQ0KDQoNCiAgICAgICAgICAgICAgICAjIENvbnZlcnQgdGhlIHBsb3QgdG8gYW4gaW4tbWVtb3J5IGZpbGUtbGlrZSBvYmplY3QNCiAgICAgICAgICAgICAgICBidWYgPSBpby5CeXRlc0lPKCkNCiAgICAgICAgICAgICAgICBwbHQuc2F2ZWZpZyhidWYsIGZvcm1hdD0ncG5nJykNCiAgICAgICAgICAgICAgICBidWYuc2VlaygwKSAgIyBNb3ZlIGN1cnNvciB0byB0aGUgc3RhcnQgb2YgdGhlIGZpbGUtbGlrZSBvYmplY3QNCg0KICAgICAgICAgICAgICAgICMgU2VuZCB0aGUgcGxvdCBkaXJlY3RseSB0byB0aGUgRGlzY29yZCB3ZWJob29rDQogICAgICAgICAgICAgICAgd2ViaG9va191cmwgPSBkYXlzX3dlYmhvb2tbZGF5XQ0KICAgICAgICAgICAgICAgIGZpbGVzID0geydmaWxlJzogKCdwbG90LnBuZycsIGJ1ZiwgJ2ltYWdlL3BuZycpfQ0KICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh3ZWJob29rX3VybCwgZmlsZXM9ZmlsZXMpDQoNCiAgICAgICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6DQogICAgICAgICAgICAgICAgICAgIHByaW50KCJQbG90IHNlbnQgc3VjY2Vzc2Z1bGx5IHRvIERpc2NvcmQhIikNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIHNlbmQgdGhlIHBsb3QgdG8gRGlzY29yZC4iKQ0KDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgIHByaW50KGYiRXJyb3IgZmV0Y2hpbmcgZGF0YSBmcm9tIFlhaG9vIEZpbmFuY2UgZm9yIHtjcnlwdG8yfSAoe2RheX0tRGF5LCB7aX0tSW50ZXJ2YWwpOiB7ZX0iKQ0KDQogICAgIyBTZW5kIGEgc2ltcGxlIG1lc3NhZ2UgaW5zdGVhZCBvZiB0aGUgcGxvdA0KICAgIHdlYmhvb2tfdXJsID0gZGF5c193ZWJob29rW2RheV0NCiAgICBtZXNzYWdlX2RhdGEgPSB7ImNvbnRlbnQiOiAiKiotKy0rLSstKy0rLUNPTVBMRVRFRC0rLSstKy0rLSstKioifSAgIyBNZXNzYWdlIHRvIGJlIHNlbnQNCg0KICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh3ZWJob29rX3VybCwganNvbj1tZXNzYWdlX2RhdGEpDQoNCiAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6DQogICAgICAgIHByaW50KCJNZXNzYWdlIHNlbnQgc3VjY2Vzc2Z1bGx5IikNCiAgICBlbHNlOg0KICAgICAgICBwcmludChmIkZhaWxlZCB0byBzZW5kIHRoZSBtZXNzYWdlLiBIVFRQIFN0YXR1czoge3Jlc3BvbnNlLnN0YXR1c19jb2RlfSwgUmVzcG9uc2U6IHtyZXNwb25zZS50ZXh0fSIpDQo=
'''
exec(base64.b64decode(xx))
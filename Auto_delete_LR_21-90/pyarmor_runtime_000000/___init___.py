import base64
xx = b'''
aW1wb3J0IGRpc2NvcmQNCmltcG9ydCBhc3luY2lvDQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgdGltZWRlbHRhLCB0aW1lem9uZQ0KZnJvbSBkaXNjb3JkLmV4dCBpbXBvcnQgY29tbWFuZHMsIHRhc2tzDQoNCiMgQm90IGNvbmZpZ3VyYXRpb24NClRPS0VOID0gIk1UTTBNelV4TlRFMU5UazFORFF3TlRRMk9BLkdlaDBrdi5WY0Ztd3ZPVk1XUVZXNWNmRWR1SUZGb0U1QjZ5MjlTdGtMZUhQUSINCg0KR1VJTERfSUQgPSAxMzM5OTkzMTUzNTM2NTI4NDA3DQpDSEFOTkVMX0lEUyA9IFsxMzQwMDA0OTI0MjgwNDEwMjYyLCAxMzQwMDA0OTYzNzUzMDAwOTcwLCAxMzQwMDA1MDI5MDI0NjI4OTQ3LCAxMzQwMDA1MjI5MDcyMjIwMjEyLCAxMzQwMDA1MjcyODU2NDMyNzEwXQ0KTE9HX0NIQU5ORUxfSUQgPSAxMzQxMDc4NjY2NDU2NzI3NTkyIA0KDQpDSEVDS19JTlRFUlZBTCA9IDEyMCAgIyBDaGVjayBldmVyeSAxMjAgc2Vjb25kcw0KTUFYX1JVTlRJTUUgPSA2ICogNjAgKiA2MCAgIyBTdG9wIGFmdGVyIDYgaG91cnMNCkRFTEVURV9USFJFU0hPTEQgPSB0aW1lZGVsdGEoaG91cnM9NzIpICAjIERlbGV0ZSBtZXNzYWdlcyBvbGRlciB0aGFuIDcyIGhvdXJzDQoNCg0KIyBTZXQgdXAgYm90IHdpdGggaW50ZW50cw0KaW50ZW50cyA9IGRpc2NvcmQuSW50ZW50cy5kZWZhdWx0KCkNCmludGVudHMubWVzc2FnZXMgPSBUcnVlDQppbnRlbnRzLmd1aWxkcyA9IFRydWUNCmJvdCA9IGNvbW1hbmRzLkJvdChjb21tYW5kX3ByZWZpeD0iISIsIGludGVudHM9aW50ZW50cykNCg0KQGJvdC5ldmVudA0KYXN5bmMgZGVmIG9uX3JlYWR5KCk6DQogICAgcHJpbnQoZiJMb2dnZWQgaW4gYXMge2JvdC51c2VyfSIpDQogICAgZGVsZXRlX29sZF9tZXNzYWdlcy5zdGFydCgpDQogICAgDQogICAgIyBTdG9wIGJvdCBhZnRlciAxMiBob3Vycw0KICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoTUFYX1JVTlRJTUUpDQogICAgZGVsZXRlX29sZF9tZXNzYWdlcy5jYW5jZWwoKQ0KICAgIGF3YWl0IGJvdC5jbG9zZSgpDQoNCkB0YXNrcy5sb29wKHNlY29uZHM9Q0hFQ0tfSU5URVJWQUwpDQphc3luYyBkZWYgZGVsZXRlX29sZF9tZXNzYWdlcygpOg0KICAgIG5vdyA9IGRhdGV0aW1lLm5vdyh0aW1lem9uZS51dGMpICAjIFVzZSB0aW1lem9uZS1hd2FyZSBkYXRldGltZQ0KICAgIGxvZ19jaGFubmVsID0gYm90LmdldF9jaGFubmVsKExPR19DSEFOTkVMX0lEKQ0KICAgIA0KICAgIGlmIG5vdCBsb2dfY2hhbm5lbDoNCiAgICAgICAgcHJpbnQoZiJMb2cgY2hhbm5lbCB7TE9HX0NIQU5ORUxfSUR9IG5vdCBmb3VuZCEiKQ0KICAgICAgICByZXR1cm4NCiAgICANCiAgICBmb3IgY2hhbm5lbF9pZCBpbiBDSEFOTkVMX0lEUzoNCiAgICAgICAgY2hhbm5lbCA9IGJvdC5nZXRfY2hhbm5lbChjaGFubmVsX2lkKQ0KICAgICAgICBpZiBub3QgY2hhbm5lbDoNCiAgICAgICAgICAgIHByaW50KGYiQ2hhbm5lbCB7Y2hhbm5lbF9pZH0gbm90IGZvdW5kISIpDQogICAgICAgICAgICBjb250aW51ZQ0KDQogICAgICAgIGRlbGV0ZWRfY291bnQgPSAwDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIGFzeW5jIGZvciBtZXNzYWdlIGluIGNoYW5uZWwuaGlzdG9yeShsaW1pdD0xMDApOg0KICAgICAgICAgICAgICAgIGlmIChub3cgLSBtZXNzYWdlLmNyZWF0ZWRfYXQpID4gREVMRVRFX1RIUkVTSE9MRDoNCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgbWVzc2FnZS5kZWxldGUoKQ0KICAgICAgICAgICAgICAgICAgICBkZWxldGVkX2NvdW50ICs9IDENCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJEZWxldGVkIG1lc3NhZ2UgZnJvbSB7bWVzc2FnZS5hdXRob3J9IGluIHtjaGFubmVsLm5hbWV9IikNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgZGVsZXRlZF9jb3VudCA+IDA6DQogICAgICAgICAgICAgICAgYXdhaXQgbG9nX2NoYW5uZWwuc2VuZChmIuKchSBEZWxldGVkICoqe2RlbGV0ZWRfY291bnR9KiogbWVzc2FnZXMgaW4gPCN7Y2hhbm5lbF9pZH0+LiIpDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgIHByaW50KGYiRXJyb3IgaW4ge2NoYW5uZWxfaWR9OiB7ZX0iKQ0KDQpib3QucnVuKFRPS0VOKQ==
'''
exec(base64.b64decode(xx))

import base64
xx = b'''
aW1wb3J0IGRpc2NvcmQNCmltcG9ydCBhc3luY2lvDQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgdGltZWRlbHRhLCB0aW1lem9uZQ0KZnJvbSBkaXNjb3JkLmV4dCBpbXBvcnQgY29tbWFuZHMsIHRhc2tzDQoNCiMgQm90IGNvbmZpZ3VyYXRpb24NClRPS0VOID0gIk1UTTBNelV4T0RjeU56TTVOVFl3TmpVMU9RLkdrRDhFVi5kSzZEN2pUSTMtbGVVbFlpZVl3T0N5Z0pGOFJZSGFGOG96Z1RLYyINCg0KR1VJTERfSUQgPSAxMzM5OTkzMTUzNTM2NTI4NDA3DQpDSEFOTkVMX0lEUyA9IFsxMzQwMDA1NzQxNTM2MjE1MTIxLCAxMzQwMDA1Nzc2NDIwNTAzNTkyLCAxMzQwMDA1OTUwOTM2OTc3NTIyLCAxMzQwMDA1OTkyODA4ODQ1MzUyLCAxMzQwMDA2MDUwODc0Nzg5OTE4LCAxMzQwMDA2MTYxNDI0MDYwNTA3XQ0KTE9HX0NIQU5ORUxfSUQgPSAxMzQxMDc4NjY2NDU2NzI3NTkyIA0KDQpDSEVDS19JTlRFUlZBTCA9IDEyMCAgIyBDaGVjayBldmVyeSAxMjAgc2Vjb25kcw0KTUFYX1JVTlRJTUUgPSAxMCAqIDYwICAjIFN0b3AgYWZ0ZXIgNiBob3Vycw0KREVMRVRFX1RIUkVTSE9MRCA9IHRpbWVkZWx0YShob3Vycz0zNjApICAjIERlbGV0ZSBtZXNzYWdlcyBvbGRlciB0aGFuIDM2MCBob3Vycw0KDQoNCiMgU2V0IHVwIGJvdCB3aXRoIGludGVudHMNCmludGVudHMgPSBkaXNjb3JkLkludGVudHMuZGVmYXVsdCgpDQppbnRlbnRzLm1lc3NhZ2VzID0gVHJ1ZQ0KaW50ZW50cy5ndWlsZHMgPSBUcnVlDQpib3QgPSBjb21tYW5kcy5Cb3QoY29tbWFuZF9wcmVmaXg9IiEiLCBpbnRlbnRzPWludGVudHMpDQoNCkBib3QuZXZlbnQNCmFzeW5jIGRlZiBvbl9yZWFkeSgpOg0KICAgIHByaW50KGYiTG9nZ2VkIGluIGFzIHtib3QudXNlcn0iKQ0KICAgIGRlbGV0ZV9vbGRfbWVzc2FnZXMuc3RhcnQoKQ0KICAgIA0KICAgICMgU3RvcCBib3QgYWZ0ZXIgMTIgaG91cnMNCiAgICBhd2FpdCBhc3luY2lvLnNsZWVwKE1BWF9SVU5USU1FKQ0KICAgIGRlbGV0ZV9vbGRfbWVzc2FnZXMuY2FuY2VsKCkNCiAgICBhd2FpdCBib3QuY2xvc2UoKQ0KDQpAdGFza3MubG9vcChzZWNvbmRzPUNIRUNLX0lOVEVSVkFMKQ0KYXN5bmMgZGVmIGRlbGV0ZV9vbGRfbWVzc2FnZXMoKToNCiAgICBub3cgPSBkYXRldGltZS5ub3codGltZXpvbmUudXRjKSAgIyBVc2UgdGltZXpvbmUtYXdhcmUgZGF0ZXRpbWUNCiAgICBsb2dfY2hhbm5lbCA9IGJvdC5nZXRfY2hhbm5lbChMT0dfQ0hBTk5FTF9JRCkNCiAgICANCiAgICBpZiBub3QgbG9nX2NoYW5uZWw6DQogICAgICAgIHByaW50KGYiTG9nIGNoYW5uZWwge0xPR19DSEFOTkVMX0lEfSBub3QgZm91bmQhIikNCiAgICAgICAgcmV0dXJuDQogICAgDQogICAgZm9yIGNoYW5uZWxfaWQgaW4gQ0hBTk5FTF9JRFM6DQogICAgICAgIGNoYW5uZWwgPSBib3QuZ2V0X2NoYW5uZWwoY2hhbm5lbF9pZCkNCiAgICAgICAgaWYgbm90IGNoYW5uZWw6DQogICAgICAgICAgICBwcmludChmIkNoYW5uZWwge2NoYW5uZWxfaWR9IG5vdCBmb3VuZCEiKQ0KICAgICAgICAgICAgY29udGludWUNCg0KICAgICAgICBkZWxldGVkX2NvdW50ID0gMA0KICAgICAgICB0cnk6DQogICAgICAgICAgICBhc3luYyBmb3IgbWVzc2FnZSBpbiBjaGFubmVsLmhpc3RvcnkobGltaXQ9MTAwKToNCiAgICAgICAgICAgICAgICBpZiAobm93IC0gbWVzc2FnZS5jcmVhdGVkX2F0KSA+IERFTEVURV9USFJFU0hPTEQ6DQogICAgICAgICAgICAgICAgICAgIGF3YWl0IG1lc3NhZ2UuZGVsZXRlKCkNCiAgICAgICAgICAgICAgICAgICAgZGVsZXRlZF9jb3VudCArPSAxDQogICAgICAgICAgICAgICAgICAgIHByaW50KGYiRGVsZXRlZCBtZXNzYWdlIGZyb20ge21lc3NhZ2UuYXV0aG9yfSBpbiB7Y2hhbm5lbC5uYW1lfSIpDQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIGRlbGV0ZWRfY291bnQgPiAwOg0KICAgICAgICAgICAgICAgIGF3YWl0IGxvZ19jaGFubmVsLnNlbmQoZiLinIUgRGVsZXRlZCAqKntkZWxldGVkX2NvdW50fSoqIG1lc3NhZ2VzIGluIDwje2NoYW5uZWxfaWR9Pi4iKQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICBwcmludChmIkVycm9yIGluIHtjaGFubmVsX2lkfToge2V9IikNCg0KYm90LnJ1bihUT0tFTik=
'''
exec(base64.b64decode(xx))
